#!/bin/sh

url_build() {
    url_injectable ${__url}; _injectable=$__
    url_parameters
    eval __url=${_injectable}
}

url_injectable() {
    # $1 url
    __=`echo $1                                        | \
    sed -e 's+^\(.*\)#\(.*\)$+\1${_\2_}+'              | \
    sed -e 's+^\(.*\)#\([^/]*\)/\(.*\)$+\1${_\2_}/\3+' | \
    sed -e 's+^\(.*\)#\([^/]*\)/\(.*\)$+\1${_\2_}/\3+' | \
    sed -e 's+^\(.*\)#\([^/]*\)/\(.*\)$+\1${_\2_}/\3+' | \
    sed -e 's+^\(.*\)#\([^/]*\)/\(.*\)$+\1${_\2_}/\3+' | \
    sed -e 's+^\(.*\)#\([^/]*\)/\(.*\)$+\1${_\2_}/\3+' | \
    sed -e 's+^\(.*\)#\([^/]*\)/\(.*\)$+\1${_\2_}/\3+' | \
    sed -e 's+^\(.*\)#\([^/]*\)/\(.*\)$+\1${_\2_}/\3+' | \
    sed -e 's+^\(.*\)#\([^/]*\)/\(.*\)$+\1${_\2_}/\3+' | \
    sed -e 's+^\(.*\)#\([^/]*\)/\(.*\)$+\1${_\2_}/\3+' | \
    sed -e 's+^\(.*\)#\([^/]*\)/\(.*\)$+\1${_\2_}/\3+' | \
    cat`
}

url_parameters() {
    array_len "__args_m"; _ulen=$__
    i=0
    while [ $i != ${_ulen} ]; do
        array_get "__args_m" $i; _name=$__
        array_get "__cmdline" $i; _val=$__
        eval _${_name}_=${_val} 
        i=`expr $i + 1`
    done
}
